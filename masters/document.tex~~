\documentclass[a4paper,10pt]{article}
\usepackage[warn]{mathtext}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
\usepackage{indentfirst}
%opening
\title{Разработка системы автоматизации обработки данных для переносного мюонного плотномера}
\author{Зюбин В.Е. Сизов М.М.}

\begin{document}

\maketitle

%\begin{abstract}

%\end{abstract}

\section{Введение} 
Один из основных параметров грунта, используемый в инженерной геологии и строительстве, ---
плотность. Информация о плотности грунта 
определяет объемы и состав работ при подготовке к строительству зданий, влияет на заключения о 
безопасности проводимых строительных работ, и качестве их выполнения. 

Плотность грунта измеряется либо контактными методами через замер плотности образцов, 
либо бесконтактными радиационными методами.

Привлекательность первого способа – присущая непосредственным измерениям точность, недостаток ---
локальный характер измерения (характерный объем забора – 1 дм$^{3}$), невозможность оценки объекта в целом,
и вытекающий отсюда чрезмерный объем бурильных работ.

Радиационный метод обеспечивает комплексную оценку исследуемого объекта, используется в широком классе задач ---
спектрометрическом контроле газовых и водных сред, дефектоскопии, рентгено-структурном анализе материалов и пр. 
В частности, метод подходит для определения объемного веса большинства петрографических типов пород, и практически 
не заменим для измерения плотности дисперсных грунтов. 

Однако использование гамма-плотномеров, реализующих радиационный метод измерения, связано с серьезными требованиями 
к безопасности, вызванными наличием в составе устройства источника радиоактивного излучения, --- необходимостью 
специально оборудованных мест хранения, доставки и множественных согласований с санитарно-эпидемиологическими службами. 
Эти обстоятельства стимулируют исследователей искать альтернативные подходы к измерению плотности грунта. 

Один из недавно предложенных способов исследуемый в Институте автоматики и электрометрии СО РАН ---
мюонный скважинный плотномер. За счет конструктивных решений удалось обеспечить высокую чувствительность 
датчика плотномера при измерении потока атмосферных мюонов, что позволяет сочетать приемлемое время измерения, 
безопасность эксплуатации прибора и комплексный характер получаемых оценок для плотности грунта.

На данный момент пользователь мюонного плотномера вынужден строить тарировочные кривые на миллиметровой бумаге 
и наносить данные на графики вручную. Соответственно, экстраполяция проводится «на глаз», что приводит к высокой 
погрешности при обработке данных.

%Для повышения качества обработки данных авторы прибора предложили алгоритм, автоматизирующий аппроксимацию тарировочных 
%кривых вариацией метода градиентного спуска. Используемый алгоритм аппроксимации тарировочных 
%данных обеспечивает нахождение аппроксимирующей кривой с погрешностью восстановления  
%около двух процентов в течение 10 минут. Однако, вопрос автоматизации и снижения погрешности обработки данных по-прежнему стоит на повестке дня.
%\newpage

Цель работы --- разработка системы автоматизации обработки данных для мюонного плотномера. 
Данная цель достигается посредством решения следующих задач:

\begin{itemize}
 \item Анализ специфики измерений мюонным плотномером 
 \item Построение физической модели генерации и поглощения средой атмосферных мюонов
 \item Формирование требований к системе автоматизации обработки данных
 \item Разработка модуля генерации синтетических данных 
 \item Определение алгоритмов обработки данных 
 \item Разработка архитектуры системы автоматизации и интерфейса пользователя к ней
 \item Реализация системы автоматизации обработки данных
\end{itemize}


Исследование в работе алгоритмов последующей обработки экспериментальных данных поглощения мюонов
снижает погрешность при измерениях, упрощает работу оператора системы, кроме того 
сокращает время измерения плотности грунта.


Данная работа описана в трех главах. В первой главе описывается анализ предметной области, построение физической 
модели рождения атмосферных мюонов и их переноса в веществе, формирование требований к системе автоматизации. Во второй главе
описываются алгоритмы генерации и обработки данных, архитектура системы автоматизации. В третьей главе описаны вопросы реализации, 
результаты тестирования на реальных данных.

\section{Предметная область}
Данные о плотности грунта служат основанием для оценки залежей полезных ископаемых 
и принятия решения о начале геологоразведки перспективных районов. На основании  информации о плотности грунта 
определяются порядок, объемы и состав проектных работ при подготовке к строительству зданий и дорог, делаются заключения о безопасности проводимых 
строительных работ, качестве их выполнения и возможности ввода в эксплуатацию возведенных сооружений. При подготовке ряда объектов 
(фундаментов зданий, шоссе, железнодорожных насыпей) проводятся 
работы по уплотнению грунта, для определения объема которых необходимы измеренные и требуемые значения показателей плотности сухого грунта.
Мониторинг плотности грунта позволяет контролировать и упреждать возникновение аварийных ситуаций при эксплуатации уже возведенных объектов, 
в частности, таких, как высотные здания, мосты, железнодорожные насыпи, линии метро, шахты, аэродромы.


\subsection{Методы измерения плотности грунта в геологии}

Плотность грунта измеряется либо контактными методами через непосредственный замер плотности образцов, 
либо бесконтактными, либо радиационными методами. 
В обоих случаях предполагается бурение исследуемого грунта. 

\subsubsection{Контактные методы}

В ГОСТ-5180-84. ``Грунты. Методы лабораторного определения физических характеристик`` описаны следующие 
методы измерения плотности грунта --- режущим кольцом, взвешивание в воде парафинированных образцов, и 
взвешивание мерзлых пород в нейтральных жидкостях . В зависимости от типа грунта, его сыпучести и содержания воды,
выбирается тот или иной метод. Масса образца грунта оставляет от пары сотен грамм до нескольких килограмм. При этом, чтобы получить 
распределение плотности грунта проводится ряд параллельных замеров. Значение характеристик вычисляют как 
среднее арифметическое из результатов параллельных определений. 
Разница между параллельными определениями не должна превышать значений, указанных в приложении к ГОСТ-5180-84. 
Если разница превышает допустимую, количество определений следует увеличить.

Главный недостаток контактных методов --- локальный характер измерения плотности грунта, связанные с этим проблемы с определением 
неоднородностей (полости, каверны) в грунте. Во время эксплуатации объектов подобные неоднородности могут привести к обрушениям или осадке фундамента. 
Цена за низкую погрешность итоговых значений плотности --- чрезмерный объем бурильных и лабораторных работ. 

\textit{По ссылке --- статья про женщину, под которой провалился асфальт от того, что грунт вымыло потоком воды, я не знаю включать ли этот случай в текст 
диплома} 

http://www.bbc.co.uk/russian/russia/2012/01/120108\_bryansk\_toddler\_killed.shtml

\subsubsection{Бесконтактные методы}

Метод радиоизотопного измерения плотности грунтов основан на зависимости между плотностью контролируемого 
грунта и характеристиками ослабления и рассеяния измеряемого потока энергии гамма-излучения.

Плотность грунта измеряется путем детектирования и регистрации плотности потока рассеянного первичного 
гамма-излучения (метод альбедо), ослабленного первичного гамма-излучения (метод абсорбции) или 
рассеянного и ослабленного первичного гамма-излучения (альбедно-абсорбционный метод).

Метод альбедо заключается в регистрации плотности потока гамма-квантов,рассеянных на электронах атомов 
вещества при взаимодействии потока энергии первичного гамма-излучения источника ионизирующего излучения с материалом грунта.
Метод абсорбции --- в детектировании плотности потока гамма-квантов, прошедших через слой материала 
между радиоактивным источником и детектором гамма-излучения.
Альбедо-абсорбционный метод заключается в определении плотности потока гамма-квантов, рассеянных 
в объеме грунта и прошедших через слой между источником ионизирующего излучения и детектором гамма-излучения.

При проведении измерений радиоизотопными плотномерами, должны соблюдаться ``Основные санитарные правила работы с 
радиоактивными веществами и другими источниками ионизирующих излучений``, ``Нормы радиационной безопасности``, 
``Правила безопасности при транспортировании радиоактивных веществ``.

Радиационный метод обеспечивает комплексную оценку исследуемого объекта, однако не лишен недостатков --- используются
радиоактивные вещества, представляющие опасность для здоровья.


Эти обстоятельства стимулируют исследователей искать альтернативные подходы к измерению плотности грунта. 
Один из недавно предложенных способов, исследуемый в Институте автоматики и электрометрии СО РАН ---
использование в качестве источника радиации естественный радиационный фон --- атмосферные мюоны. 
Обладая достоинствами радиационных методов, мюонный плотномер 
не использует активных источников радиации и соответственно безопасен для здоровья. 

\subsection{Физическая модель рождения мюонов и их пересноса в веществе}

\subsubsection{Первичные Космические лучи}

\subsubsection{Адронные распады}

\subsubsection{Перенос частиц в веществе} % обоснование суммы экспонент


\subsection{Устройство и работа мюонного плотномера}

Атмосферные мюоны образуются при распаде пионов и каонов, 
рождающихся в атмосфере Земли под действием потока частиц 
первичных космических лучей, бомбардирующих атмосферу. 
В зависимости от энергии эти мюоны могут проникать на глубины 
до нескольких тысяч метров ниже уровня моря и более. Величина 
потока мюонов на различных глубинах определяется 
энергетическим спектром и составом космических лучей, 
а также физикой взаимодействия мюонов с веществом. Но общая 
закономерность --- ее монотонное падение с глубиной. 
Второе значимое обстоятельство, позволяющее использовать мюоны 
в практических целях измерения плотности грунта, --- относительное 
постоянство их интенсивности во времени. Поэтому 
в геологических задачах, когда точность регистрации 
интенсивности не более 3--5 процентов,  
изменениями в интенсивности пренебрегают.

\subsubsection{Принцип измерения плотности породы по тарировочной кривой}

В мюонных плотномерах используются абсорбционный метод, 
основанный на замере потока мюонов при прохождении
через вещество. Интенсивность потока мюонов определяется 
средней плотностью горных пород над точкой наблюдения, 
поэтому в качестве единицы измерения глубины 
при наблюдениях в шахтах используют метры водного эквивалента
, сокращенно --- \textit{м. в. э.}. 

При измерении в исследуемом грунте делается скважина, 
в скважину опускается прибор, включающий сцинтилляционный датчик, 
и на разных глубинах замеряется поток частиц. 
Тарировочная зависимость интенсивности потока 
мюонов от глубины в м. в. э. позволяет найти глубину 
в м. в. э., соответствующую измеренному потоку мюонов,
а затем по фактическим глубинам, на которых делались замеры, 
определить среднюю плотность вещества между точками измерения:

\begin{center}
$\mathit{\rho = \frac{H_{m.w.e.}(I_1) - H_{m.w.e.}(I_2)}{H_1-H_2}}$, где
\end{center}


$H_{m.w.e.}(I_1)$ --- глубина в м. в. э. для интенсивности потока мюонов $I_1$, измеренной на глубине $H_1$
$H_{m.w.e.}(I_2)$ --- глубина в м. в. э. для интенсивности потока мюонов $I_2$, измеренной на глубине $H_2$

Однако известные приборы громоздки и требуют больших затрат времени 
на измерения, что делает их малопригодными для практического 
использования в инженерной геологии и строительстве. 

Для повышения точности измерений необходимо учитывать и свести 
к минимуму статистическую погрешность регистрации скорости 
счета и систематическую погрешность, возникающую при 
изготовлении скважины в зависимости от свойств грунта и 
диаметра скважины.

\subsubsection{Пилотный вариант мюонного скважинного плотномера}

\begin{center}
<Place for image here>
Рис.1. Датчик мюонного плотномера
\end{center}


В целях снижения временных затрат на измерения с повышением 
их точности была предложена конструкция датчика мюонного 
скважинного плотномера (Рис. 1), включающая сцинтилляционный 
детектор (1) с оболочкой (2) и стеклом окна (3), 
фотоумножитель (ФЭУ) (4), усилитель-дискриминатор (5) 
и пульт управления (6).

Физическая длина сцинтилляционного детектора выбирается из 
следующих ограничений. Сцинтилляционная вспышка, 
возникшая на максимальном удалении от фотокатода ФЭУ 
при взаимодействии с мюоном, должна при достижении фотокатода 
иметь достаточно высокий уровень, позволяющий отделить это 
событие от тех сцинтилляционных вспышек, обусловленных 
естественной радиоактивностью исследуемой породы, которые 
возникающих в непосредственной близости от ФЭУ. Это условие 
ограничивают длину сцинтилляционного детектора сверху и 
зависит от коэффициента ослабления света сцинтилляции, 
который для различных сцинтилляционных материалов может 
быть определен расчетом или экспериментально. 

В усилителе-дискриминаторе предусмотрен регулируемый по 
пространственному разрешению плотности порог дискриминации. 
Это позволяет исключить при измерении вклад естественной 
радиоактивности в зависимости от радионуклидов, содержащихся в 
исследуемом грунте, а также регулировать длину рабочего участка 
сцинтилляционного детектора, тем самым настраивая разрешение под 
требования задачи.

В датчике могут быть использованы неорганические, 
органические, пластические и жидкие сцинтилляционные материалы,
что позволяет варьировать как габариты датчика, 
так и его стоимость. 


\begin{center}
<Place for image here>
Рис.2. Датчик мюонного плотномера
\end{center}

Предложенная конструкция мюонного скважинного плотномера была 
реализована в пилотном варианте (рис. 2). Плотномер имеет 
герметичный металлический корпус, рассчитанный под диаметр 
обсадной трубы 76 мм. В качестве сцинтилляционного материала 
использован $NaJ(Tl)$. В состав прибора включен 
фотоэлектронный умножитель ФЭУ-93 и  усилитель-дискриминатор, 
выполненный на триггере Шмидта, выход которого согласован с 
блоком управления. Блок управления и регистрации представляет 
собой серийно выпускаемый счетчик импульсов от радиоизотопного 
плотномера ППГР-1. Питание плотномера осуществляется от 
портативного приборного аккумулятора 12 В, 3 А$*$ч. 
Эксплуатационные характеристики макетного варианта 
были опробованы при замере зависимости интенсивности потока 
мюонов от глубины, на воде. 

Резюмируя достоинства мюонного плотномера следует отметить:
\begin{itemize}
  \item Экологическую и биологическую безопасность прибора и 
  связанную с этим простоту эксплуатации при хранении, 
  транспортировке. Отсутствие необходимости в 
  согласованиях его использования с санитарно-эпидемиологическими 
  службами.
  \item Простоту калибровки датчика, не требующей специальных 
  приспособлений. Калибровку проводят в открытых естественных 
  водоемах, на воде – жидкости с низким коэффициентом сжатия. 
  \item Существенное снижение (до двух порядков) объема 
  буровых работ  за счет интегрального характера обследования, 
  значимое особенно в случае дисперсионных грунтов.
  \item Практически приемлемую погрешность (порядка 3\%) и 
  продолжительность измерений (не более 60 минут для глубин до 
  20 м. в. э.).
  \item Компактную конструкцию прибора (длина 0.9 м, масса 7 кг) 
  и простоту его эксплуатации в автономном режиме в течение 8 
  часов непрерывной работы.
\end{itemize}





\section{Алгоритмы генерации и обработки данных}

В этой главе описываются используемые алгоритмы генерации синтетических данных и экстраполяции тарировочных данных. 


\subsection{Постановка задачи экстраполяции тарировочных кривых}

Качество обработки результатов измерения существенно влияет на погрешность получаемых результатов, которая в первую очередь определяется
качеством восстановления зависимости интенсивности потока мюонов от глубины в м. в. э..


\subsubsection{Методы решения задач аппроксимации функций}
% поправить слова
Метод наименьших квадратов - один из базовых для оценки неизвестных параметров моделей по набору данных, при этом исследуется на минимум 
следующая функция


\begin{center}
 $ s(\vec{p}) = \left| f(x_t, \vec{p}) - y_t \right| ^ 2 \rightarrow min $
\end{center}


Где $\vec{p}$ --- вектор оцениваемых параметров модели, $f(x_t, \vec{p}) $ --- функция, аппроксимирующая значения $y_i$ в точках $x_i$.


Если существует аналитическое решение системы 

\begin{center}
 $ \displaystyle\sum_{t = 1}^n \left( y_t - f(x_t,\vec{p})\right) \frac{\partial f(x_t, \vec{p})}{\partial b_i} = 0 $
\end{center}


, то говорят о линейной задаче меньших квадратов, иначе --- о нелинейной задаче.


\subsubsection{Линейная задача меньших квадратов}






Тарировочные данные, полученные при получении тарировочной кривой на воде, показывают, что интенсивность потока мюонов падает монотонно с
глубиной, а первая производная интенсивности монотонно возрастает от отрицательных значений, к нулю. Этот факт послужил основанием для отказа 
от сплайновой интерполяции, практикуемой ранее. Используя решение однородного уравнения переноса, имеющего экспоненциальный характер, было решено
искать целевую функцию в виде суммы экспонент:
\begin{center}
$\mathit{ f(t)  = \displaystyle\sum_{j=0}^M a_j exp(-b_j t) }$ 
\end{center}


% Критерии, кроме того нужно рассказать про non-liner aleast squares

В качестве критерия была выбрана следующая норма (Зюбина--Петухова ): 
\begin{center}

$s(\vec{a}, \vec{b}) = \displaystyle\sum_{i=0}^N \left|\frac{f(a_j, b_j, i) - y_i}{min(f(a_j, b_j, i), y_i)}\right|^2 \frac{100\%}{N} \rightarrow min$ %enum

\end{center}
Данный критерий похож на взвешенную задачу наименьших квадратов нелинейных функций, в иностранной литературе можно встретить следующее название 
Weightened Non-Linear Least Squares Problem. Эта задача отличается от задачи минимизации наименьших квадратов делителем зависящим от номера измерения : 
\begin{center}
$w(\vec{a}, \vec{b}) = \displaystyle\sum_{i=0}^N \frac{\left|f(a_j, b_j, i) - y_i\right|^2}{w_i} \rightarrow min$
\end{center}
Один из способов решения задачи - взешивание измерений, затем используется любой из существующих методов для нахождения наименьших квадратов нелинейных функций.


Однако, поскольку в критерии Зюбина-Петухова в знаменателе находится функция зависящая от минимизируемых параметров, данный подход не работает. Упростим $k$-е слагаемое выражения %enum
(для краткости опустим постоянные множители $N$, $100\%$) : 

\begin{center}
 \LARGE{$ \left|\frac{f(a_j, b_j, k) - y_k}{min(f(a_j, b_j, k), y_k)}\right|^2 = \left\{ {
    \left| 1 - \frac{y_k}{f(a_j, b_j, k)}\right|^2 , f(a_j, b_j, k) < y_k  \atop 
    \left| 1 - \frac{f(a_j, b_j, k)}{y_k}\right|^2 , f(a_j, b_j, k) > y_k  
 } \right. $}
\end{center}

Таким образом, разбивая $ 2 M $--мерное пространство параметров $ \vec{a}, \vec{b}$ на две области, мы можем сформулировать критерий в терминах задачи наименьших квадратов нелинейных функций.
Рассмотрим кусочно-гладкую функцию $\fi(\vec{a}, \vec{b})$: 
\begin{center}
$ \fi(\vec{a}, \vec{b}) = \left\{ {
    \frac{y_k}{f(a_j, b_j, k)} , f(a_j, b_j, k) < y_k  \atop 
    \frac{f(a_j, b_j, k)}{y_k} , f(a_j, b_j, k) > y_k  
 } \right.$
\end{center}

Решая задачу о наименьших квадратах для функции $\fi(\vec{a}, \vec{b})$ на постоянном векторе данных, заполненным единицами получаем решение для минимизации нормы 
Зюбина-Петухова, используя стандартные методы: 
$v(\vec{a}, \vec{b}) = \displaystyle\sum_{i=0}^N \left|1 - \fi(\vec{a}, \vec{b})\right|^2 \rightarrow min \rightarrow min$


\subsection{Генерация синтетических данных}


Получение большого набора тестовых измерений (исходных данных для тарировочных кривых) сопряжено с рядом трудностей. Поскольку плотномер находится в активной разработке,
большую часть времени прибор недоступен для проведения тестовых измерений. Кроме того, примерное время одной серии измерений составляет около часа. Соответственно 
для получения большего набора данных время растёт пропорционально.


Ввиду перечисленных сложностей, было решено в качестве тестовых данных для алгоритмов использовать синтетические данные. Было рассмотрено два подхода моделирования данных -- 
полная симуляция потока мюонов, генерация зашумленных данных на основе известной целевой функции (суммы монотонно убывающих экспонент).


\subsubsection{Программный пакет MUSIC}


Был исследован ряд статей и монографий описывающих подходы и существующие решения по моделированию мюонов <ссылки>. В результате в качестве ПО для генерации потока мюонов
был выбран программный пакет MUSIC (MUon SImulation Code).Он обладает рядом достоинств -- 
%тут надо поправить текст/найти индекс цитирования
результаты его моделирования находятся в соответствии с экспериментальными данными в широкой области от нескольких ГэВ до 1 ТэВ (тогда как ряд моделей <ссылка> обладают
недостатком мюонов в определенных областях энергий), программный пакет доступен бесплатно, доступен его исходный код. Автор пакета Кудрявцев В.А. <ссылка> дал несколько 
советов по моделированию потока мюонов в среде.


Программный пакет MUSIC проводит моделирование в 3х измерениях с помощью метода Монте-Карло. Взаимодействие мюонов с материей с высокими потерями энергии рассматриваются 
как стохастические процессы. При этом учитываются угловое отклонение и смещение мюонов из-за множественного рассеяния на ядрах атомов, потери энергии на тормозное излучение
и неупругое рассеяние. В данной работе для каждого тестового измерения проводилась симуляция 5000 мюонов и из статистики определялась вероятность выживания мюонов на заданной глубине. 
Для тестирования алгоритмов было проведено 34 серии измерений по 10 измерений в серии. 


\subsubsection{Генерация данных на основе целевой функции}


Проверка алгоритмов на основе симуляции потока мюонов обладает одним недостатком -- неизвестна зависимость флуктуаций от приближаемой кривой зависимости интенсивности 
потока от глубины. По этой причине была проведена другая серия синтетических измерений. В этой серии из допустимого диапазона параметров случайно определялись параметры 
экспонент, определялся "поток мюонов" на глубине и затем к этим данным добавлялся шум в пределах 5\% относительной погрешности.



\subsection{Алгоритмы экстраполяции тарировочной кривой}

В ходе работы были рассмотрены следующие алгоритмы:

\begin{itemize}
 \item Прони-подобные алгоритмы
 \subitem Алгоритм Прони
 \subitem Модифицированный алгоритм Прони(Осборн)
 \subitem Алгоритм Кунга
 \item Алгоритм Левенберга-Марквардта
 \item Модификация жадного алгоритма
 
\end{itemize}

Описание алгоритмов дается в соответствующих секциях

\subsubsection{Алгоритм Прони}
Prony's method) was developed by Gaspard Riche de Prony in 1795. However, practical use of the method 
awaited the digital computer.[1] Similar to the Fourier transform, Prony's method extracts valuable information
from a uniformly sampled signal and builds a series of damped complex exponentials or sinusoids. This allows for 
the estimation of frequency, amplitude, phase and damping components of a signal.

Алгоритм Прони был разработан Гаспаром Рише де Прони в 1795 году. Чаще всего этот метод рассматривается в качестве метода анализа сигналов (выделения экспоненциально--затухающих
синусоидальных гармоник), но так же 
\subsubsection{Модифицированный алгоритм Прони(Осборн)}

\subsubsection{Алгоритм Кунга}

\subsubsection{Алгоритм Левенберга-Марквардта}

\subsubsection{Архитектура системы автоматизации обработки данных}

Рабочее место оператора состоит из <>. Оператор получает файл с тарировочными кривыми, затем АРМ оператора считает рисует график проводится измерение


\section{Результаты работы}

\subsection{Модификации алгоритмов}

%В третьей главе описаны вопросы реализации, 
%результаты тестирования на реальных данных.
\subsection{Результаты тестирования алгоритмов на синтетических данных}
% две картиночки с результатами на одних данных и на другом наборе

\subsection{Результаты тестирования алгоритмов на экспериментальных данных}

\section{Библиография}


%Проблемы/подходы - размеры датчика, восстановление неоднородностей по ряду измерений, условие прекращения измерения
\end{document}
